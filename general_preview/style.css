
/* ===== Lottie multi-layer — safe patch (не ломает остальной UI) ===== */
#preview, .preview { position: relative; overflow: hidden; }

/* Сцена слоёв строго внутри превью */
#preview > .multi-stage {
  position: absolute; inset: 0;
  z-index: var(--lottie-z, 4);
  pointer-events: none;
  overflow: hidden;
}

/* Слой и плеер — только функциональные правила */
#preview > .multi-stage .lot-layer {
  position: absolute; left: 0; top: 0;
  pointer-events: auto;
  outline: 0;
}
#preview > .multi-stage .lot-layer .lot-player {
  position: relative; display: inline-block;
}

/* Видимое выделение выбранного слоя */
#preview > .multi-stage .lot-layer.selected {
  outline: 1px dashed var(--accent, #6ee7b7);
  outline-offset: 2px;
}

/* Гарантия видимости содержимого Lottie (на случай глобальных стилей) */
#preview > .multi-stage svg {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
  mix-blend-mode: normal !important;
  filter: none !important;
  isolation: isolate !important;
  transform: translateZ(0);
}

/* Фон/плейсхолдер остаются ниже слоёв */
#background, #bgImg {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: contain;
  z-index: 0;
  pointer-events: none;
}
#ph { z-index: 1; }

/* Если контейнер плеера внезапно нулевой — дай «тело» по умолчанию */
#preview > .multi-stage .lot-layer .lot-player:empty::after {
  content: "";
  display: block;
  width: 256px;
  height: 256px;
}

/* Подсветка DnD — если вы используете класс drop-active на body */
body.drop-active #preview::after {
  content: "Отпустите файлы для загрузки";
  position: absolute; inset: 0; z-index: 9999;
  display: grid; place-items: center;
  color: #fff; background: rgba(46,58,85,0.35);
  border: 2px dashed var(--accent, #6ee7b7);
  font-weight: 600; letter-spacing: .2px; pointer-events: none;
}
